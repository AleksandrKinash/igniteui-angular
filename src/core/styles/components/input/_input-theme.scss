$component-name: 'igx-input';

$components: register-component($components, #{$component-name});

@function igx-input-theme(
    $idle-text-color: null,
    $filled-text-color: null,
    $focused-text-color: null,
    $disabled-text-color: null,
    $placeholder-text-color: null,

    $idle-accent-color: null,
    $filled-accent-color: null,
    $focused-accent-color: null,
    $disabled-accent-color: null,

    $success-accent-color: null,
    $warning-accent-color: null,
    $error-accent-color: null
) {
    @return (
        idle-text-color: $idle-text-color,
        filled-text-color: $filled-text-color,
        focused-text-color: $focused-text-color,
        disabled-text-color: $disabled-text-color,
        placeholder-text-color: $placeholder-text-color,

        idle-accent-color: $idle-accent-color,
        filled-accent-color: $filled-accent-color,
        focused-accent-color: $focused-accent-color,
        disabled-accent-color: $disabled-accent-color,

        success-accent-color: $success-accent-color,
        warning-accent-color: $warning-accent-color,
        error-accent-color: $error-accent-color
    );
}

@mixin igx-input($theme, $palette: $default-palette) {
    $default-theme: igx-input-theme(
        $idle-text-color: igx-color($palette, 'grays', 600),
        $filled-text-color: igx-color($palette, 'grays', 900),
        $focused-text-color: igx-color($palette, 'grays', 900),
        $disabled-text-color: igx-color($palette, 'grays', 500),
        $placeholder-text-color: igx-color($palette, 'grays', 600),

        $idle-accent-color: igx-color($palette, 'grays', 600),
        $filled-accent-color: igx-color($palette, 'grays', 600),
        $focused-accent-color: igx-color($palette, 'primary'),
        $disabled-accent-color: igx-color($palette, 'grays', 500),

        $success-accent-color: igx-color($palette, 'success', 500),
        $warning-accent-color: igx-color($palette, 'warn', 500),
        $error-accent-color: igx-color($palette, 'error', 500)
    );

    $this: extend($default-theme, $theme);

    // @debug $this;

    // Input Box
    $input-min-height: rem(70px) !default;
    $input-font-size: rem(16px) !default;
    $input-font-weight: 400 !default;
    $input-line-height: rem(24px) !default;

    $input-color: map-get($this, 'idle-text-color') !default;
    $input-caret-color: map-get($this, 'focused-accent-color') !default;

    $input-border-color: igx-color($palette, 'accent', 500) !default;
    $input-border: inset 0 -1px 0 0 $input-border-color !default;

    $input-border-success: inset 0 -2px 0 0 map-get($this, 'success-accent-color') !default;
    $input-border-warn: inset 0 -2px 0 0 map-get($this, 'warning-accent-color') !default;
    $input-border-error: inset 0 -2px 0 0 map-get($this, 'error-accent-color') !default;

    $input-border-color-focus: map-get($this, 'focused-accent-color') !default;
    $input-border-focus: inset 0 -2px 0 0 map-get($this, 'focused-accent-color') !default;

    $input-background: $white !default;
    $input-transition: all .2s ease-in !default;
    $input-placeholder-color: $input-border-color !default;
    $input-error-color: $input-color !default;
    $input-success-color: $input-color !default;
    $input-disabled-color: igx-color($palette, 'grays', 500) !default;
    $input-disabled-solid-color: $input-disabled-color !default;

    // Floating Label
    $label-color: igx-color($palette, 'grays', 600) !default;
    $label-color-disabled: igx-color($palette, 'grays', 500) !default;
    $label-focus-color: map-get($this, 'focused-accent-color') !default;
    $label-active-color: lighten($label-color, 20%) !default;
    $label-success-color: map-get($this, 'success-accent-color') !default;
    $label-warn-color: map-get($this, 'warning-accent-color') !default;
    $label-error-color: map-get($this, 'error-accent-color') !default;
    $label-font-size: rem(16px) !default;
    $label-focus-font-size: rem(12px) !default;
    $input-search-padding: 12px 12px 12px 64px !default;
    $input-search-label-padding: 12px 16px !default;
    $input-margin: 20px 0 !default;

    %igx-input-display {
        display: block;
        margin: $input-margin;
        position: relative;
        min-height: 40px;
    }

    %igx-form-label {
        display: block;
        position: absolute;
        overflow: hidden;
        top: 0;
        transform-origin: bottom left;
        font-size: $input-font-size;
        line-height: $input-line-height;
        color: $label-color;
        cursor: text;
        user-select: none;
        pointer-events: none;
        transform: translate3d(0, 0, 0);
        transition: transform .25s $ease-in-out-quad, color .25s $ease-in-out-quad;
    }

    %igx-form-label--float {
        color: $label-active-color;
        transform: translateY(-20px) perspective(1000px) translateZ(-300px);
    }

    %igx-form-label--filled {
        color: map-get($this, 'filled-accent-color');
    }

    %igx-form-label--focused {
        color: map-get($this, 'focused-accent-color');
        transform: translateY(-20px) perspective(1000px) translateZ(-300px);
    }

    %igx-form-input {
        width: 100%;
        border: 0;
        outline-style: none;
        color: map-get($this, 'idle-text-color');
        background: transparent;
        font-size: $input-font-size;
        font-weight: $input-font-weight;
        line-height: $input-line-height;
        padding-bottom: 3px;
        box-shadow: inset 0 -1px 0 0 map-get($this, 'idle-accent-color');
        transition: box-shadow .25s $ease-in-out-quad;

        &::-webkit-input-placeholder {
            color: map-get($this, 'placeholder-text-color');
        }
    }

    %igx-form-input--filled {
        color: map-get($this, 'filled-text-color');
    }

    %igx-form-input--focused {
        color: map-get($this, 'focused-text-color');
        box-shadow: inset 0 -2px 0 0 map-get($this, 'focused-accent-color');
    }

    %igx-form-input--disabled {
        user-select: none;
        cursor: not-allowed;
        -webkit-text-fill-color: $input-disabled-color;
        box-shadow: none;
        background-image: linear-gradient(to right, $input-disabled-color 20%, transparent 10%);
        background-position: bottom;
        background-size: 5px 1px;
        background-repeat: repeat-x;
    }

    %igx-form-label--disabled {
        color: map-get($this, 'disabled-text-color');
    }

    %igx-form-input--success {
        box-shadow: $input-border-success;
    }

    %igx-form-label--success {
        color: $label-success-color;
    }

    %igx-form-input--warn {
        box-shadow: $input-border-warn;
    }

    %igx-form-label--warn {
        color: $label-warn-color;
    }

    %igx-form-input--error {
        box-shadow: $input-border-error;
    }

    %igx-form-label--error {
        color: $label-error-color;
    }

    %igx-textarea {
        resize: none;
    }

    %igx-search-input {
        background: $white;
        padding: $input-search-padding;
        border-radius: 2px;
        font-size: $input-font-size;
        box-shadow: $elevate-2;
        transition: box-shadow .2s $ease-in-out-quad;

        &:hover,
        &:focus {
            box-shadow: $elevate-5;
        }
    }

    %igx-input-clear,
    %igx-search-label {
        max-height: 100%;
        padding: $input-search-label-padding;
        color: $off-black;
    }

    %igx-input-clear {
        position: absolute;
        visibility: visible;
        top: 0;
        right: 0;
        cursor: pointer;
    }

    %igx-input-clear--hidden {
        visibility: hidden;
        pointer-events: none;
    }
}
