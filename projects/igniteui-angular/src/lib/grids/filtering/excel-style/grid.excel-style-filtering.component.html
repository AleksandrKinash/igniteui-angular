<ng-template #defaultExcelStyleColumnOperationsTemplate>
    <div *ngIf="column.sortable">
        <igx-excel-style-sorting #excelStyleSorting
            class="igx-excel-filter__sort"
            [column]="column"
            [grid]="grid"
            [displayDensity]="grid.displayDensity">
        </igx-excel-style-sorting>
    </div>

    <div *ngIf="column.movable">
        <igx-excel-style-column-moving
            class="igx-excel-filter__move"
            [column]="column"
            [grid]="grid"
            [isColumnPinnable]="isColumnPinnable"
            [displayDensity]="grid.displayDensity">
        </igx-excel-style-column-moving>
    </div>

    <!-- pinning -->
    <div *ngIf="!column.disablePinning && grid.displayDensity==='comfortable'">
        <div [ngClass]="pinClass()"
            (click)="onPin()"
            tabindex="0"
            *ngIf="!column.pinned">
            <span>{{ grid.resourceStrings.igx_grid_excel_pin }}</span>
            <igx-icon fontSet="filtering-icons" name="pin"></igx-icon>
        </div>
        <div class="igx-excel-filter__actions-unpin"
            (click)="onPin()"
            tabindex="0"
            *ngIf="column.pinned">
            <span>{{ grid.resourceStrings.igx_grid_excel_unpin }}</span>
            <igx-icon fontSet="filtering-icons" name="unpin"></igx-icon>
        </div>
    </div>
    <!-- pinning -->

    <!-- hiding -->
    <div *ngIf="!column.disableHiding && grid.displayDensity==='comfortable'">
        <div class="igx-excel-filter__actions-hide"
            tabindex="0"
            (click)="onHideToggle()">
            <span>{{ column.hidden ? grid.resourceStrings.igx_grid_excel_show : grid.resourceStrings.igx_grid_excel_hide }}</span>
            <igx-icon>{{ column.hidden ? 'visibility' : 'visibility_off' }}</igx-icon>
        </div>
    </div>
    <!-- hiding -->

    <!-- selecting -->
    <div *ngIf="columnSelectable() && grid.displayDensity==='comfortable'">
        <div [ngClass]="selectedClass()"
            tabindex="0"
            (click)="onSelect()">
            <span>{{grid.resourceStrings.igx_grid_excel_select }}</span>
            <igx-icon fontSet="material"  >done</igx-icon>
        </div>
    </div>
    <!-- selecting -->
</ng-template>

<ng-template #defaultExcelStyleFilterOperationsTemplate>
    <!-- clear filter -->
    <div tabindex="0"
            [ngClass]="clearFilterClass()"
            (keydown)="onClearFilterKeyDown($event)"
            (click)="clearFilter()">
        <span>{{ grid.resourceStrings.igx_grid_excel_filter_clear }}</span>
        <igx-icon>clear</igx-icon>
    </div>
    <!-- clear filter -->

    <!-- conditional filter -->
    <div tabindex="0"
        class="igx-excel-filter__actions-filter"
        (keydown)="onTextFilterKeyDown($event)"
        (click)="onTextFilterClick($event)"
        [igxDropDownItemNavigation]="subMenu" >
        <span>{{ subMenuText }}</span>
        <igx-icon>keyboard_arrow_right</igx-icon>
    </div>
    <!-- conditional filter -->

    <igx-excel-style-search #excelStyleSearch
        class="igx-excel-filter__menu-main"
        [column]="column"
        [data]="listData"
        [grid]="grid"
        [inline]="inline"
        [displayDensity]="grid.displayDensity">
    </igx-excel-style-search>
</ng-template>

<article #dropdown
    *ngIf="column"
    class="igx-excel-filter__menu"
    [ngClass]="{
        'igx-excel-filter__menu--cosy': grid.displayDensity === 'cosy',
        'igx-excel-filter__menu--compact': grid.displayDensity === 'compact'
    }"
    [id]="overlayComponentId"
    (keydown)="onKeyDown($event)"
    [style.min-height]="minHeight"
    [style.max-height]="maxHeight">

    <header class="igx-excel-filter__menu-header">
        <h4>{{ column.header || column.field }}</h4>
        <div *ngIf="grid.displayDensity!=='comfortable'" class="igx-excel-filter__menu-header-actions">
            <button *ngIf="columnSelectable()" igxButton="icon"
            [displayDensity]="grid.displayDensity" (click)="onSelect()"
            tabindex="0" [ngClass]='selectedClass()'>
             <igx-icon fontSet="material">done</igx-icon>
            </button>
            <button *ngIf="!column.disablePinning && !column.pinned"
                igxButton="icon"
                [displayDensity]="grid.displayDensity"
                (click)="onPin()"
                [disabled]="!isColumnPinnable"
                tabindex="0">
                <igx-icon fontSet="pinning-icons" name="pin"></igx-icon>
            </button>
            <button *ngIf="!column.disablePinning && column.pinned"
                igxButton="icon"
                [displayDensity]="grid.displayDensity"
                (click)="onPin()"
                tabindex="0">
                <igx-icon fontSet="pinning-icons" name="unpin"></igx-icon>
            </button>
            <button *ngIf="!column.disableHiding"
                igxButton="icon"
                [displayDensity]="grid.displayDensity"
                tabindex="0"
                (click)="onHideToggle()">
                <igx-icon>{{ column.hidden ? 'visibility' : 'visibility_off' }}</igx-icon>
            </button>
        </div>
    </header>

    <ng-container *ngTemplateOutlet="columnOperationsTemplate"></ng-container>
    <ng-container *ngTemplateOutlet="filterOperationsTemplate"></ng-container>

    <footer class="igx-excel-filter__menu-footer">
        <button igxButton [displayDensity]="grid.displayDensity" (click)="cancel()">{{ grid.resourceStrings.igx_grid_excel_cancel }}</button>
        <button igxButton="raised" [displayDensity]="grid.displayDensity" [disabled]="applyButtonDisabled" (click)="applyFilter()">{{ grid.resourceStrings.igx_grid_excel_apply }}</button>
    </footer>
</article>

<igx-drop-down
    *ngIf="column"
    #subMenu
    [maxHeight]="'397px'"
    [displayDensity]="grid.displayDensity"
    (onSelection)="onSubMenuSelection($event)"
    (onClosed)="onSubMenuClosed()">
    <div>
        <igx-drop-down-item
        *ngFor="let condition of conditions"
        [value]="condition">
            <igx-icon fontSet="filtering-icons" [name]="getCondition(condition).iconName"></igx-icon>
            <span style="margin-left: 16px">{{ translateCondition(condition) }}</span>
        </igx-drop-down-item>
        <igx-drop-down-item *ngIf="showCustomFilterItem()">
            <igx-icon>filter_list</igx-icon>
            <span style="margin-left: 16px">{{ grid.resourceStrings.igx_grid_excel_custom_filter }}</span>
        </igx-drop-down-item>
    </div>
</igx-drop-down>

<igx-excel-style-custom-dialog
    *ngIf="column"
    #customDialog
    [column]="column"
    [filteringService]="filteringService"
    [overlayComponentId]="overlayComponentId"
    [overlayService]="overlayService"
    [displayDensity]="grid.displayDensity">
</igx-excel-style-custom-dialog>
